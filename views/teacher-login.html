<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0"
    >
    <style>
        /* container for titles */
        body {
            background-color: #D9D9D9;
            font-family: "consolas", "å¾®è»Ÿæ­£é»‘é«”";

            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #titles-container {
            height: 150px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start;
        }

        #title {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        #subtitle {
            font-size: 12px;
            font-weight: light;
        }

        /* container for é¸æ“‡ç¾æœ‰æ•™å®¤å€åŸŸ */
        #choose-exist-classrooms-container {
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #choose-exist-classrooms-title {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        #choose-exist-classroom-numbers-container {
            width: 60%;
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }

        .classroom-number {
            background-color: #000;
            color: #D9D9D9;
            font-size: 24px;
            font-weight: bold;
            border-radius: 10px;
            margin: 10px;

            width: 25%;
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .classroom-number:hover {
            cursor: pointer;
            background-color: #3b3b3b;
        }

        /* æ°´å¹³åˆ†éš”ç·š */
        hr {
            width: 80%;
            margin: 20px;
            border: 1px solid #565656;
        }

        /* container for å»ºç«‹æ–°æ•™å®¤å€åŸŸ */
        #create-new-classrooms-container {
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #create-new-classrooms-title {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        #create-new-classrooms-function-container {
            width: 30%;
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
        }

        #create-new-classrooms-function-container-left {
            width: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #random-classroom-number-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        #random-classroom-number {
            background-color: #ffffff;
            color: #000000;
            font-size: 24px;
            font-weight: bold;
            border-radius: 10px;
            margin-bottom: 10px;

            width: 80%;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #create-new-classrooms-function-container-right {
            width: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #student-list-textarea {
            background-color: #ffffff;
            color: #000000;
            font-size: 16px;
            border-radius: 5px;
            border-style: none;
            margin-bottom: 10px;
            padding: 10px 10px;

            width: 80%;
            height: 200px;

            resize: none;
        }

        #student-list-textarea:focus {
            outline: none;
        }

        #create-new-classroom-button {
            background-color: #000;
            color: #D9D9D9;
            font-size: 28px;
            font-weight: bold;
            border-radius: 10px;
            margin: 10px;

            width: 20%;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #create-new-classroom-button:hover {
            cursor: pointer;
            background-color: #3b3b3b;
        }
    </style>
    <title>è€å¸«ç™»å…¥é é¢</title>
</head>

<body>
    <!-- container for titles -->
    <div id="titles-container">
        <!-- page title ã€ŒRaise Your ğŸ–ã€ -->
        <div id="title">Raise Your ğŸ–</div>
        <!-- page subtitle ã€ŒFor Teacherã€ -->
        <div id="subtitle">For Teacher</div>
    </div>

    <!-- container for é¸æ“‡ç¾æœ‰æ•™å®¤å€åŸŸ -->
    <div id="choose-exist-classrooms-container">
        <!-- title for é¸æ“‡ç¾æœ‰æ•™å®¤å€åŸŸ -->
        <div id="choose-exist-classrooms-title">é¸æ“‡ç¾æœ‰æ•™å®¤</div>
        <!-- container for å¯é¸æ“‡çš„æ•™å®¤ç·¨è™Ÿ -->
        <div id="choose-exist-classroom-numbers-container">
            <!-- å¤šå€‹ 6 ä½æ•¸ç·¨è™Ÿå€å¡Šï¼Œå€å¡Šåˆ†å¸ƒç‚º 3 æ¬„ 1 åˆ— -->
            <!-- <div class="classroom-number"></div> -->
        </div>
    </div>

    <!-- æ°´å¹³åˆ†éš”ç·š -->
    <hr>

    <!-- container for å»ºç«‹æ–°æ•™å®¤å€åŸŸ -->
    <div id="create-new-classrooms-container">
        <!-- title for å»ºç«‹æ–°æ•™å®¤å€åŸŸ -->
        <div id="create-new-classrooms-title">å»ºç«‹æ–°æ•™å®¤</div>
        <!-- container for å»ºç«‹æ–°æ•™å®¤çš„åŠŸèƒ½ -->
        <div id="create-new-classrooms-function-container">
            <!-- container å·¦æ–¹å€å¡Š -->
            <div id="create-new-classrooms-function-container-left">
                <!-- title ã€Œéš¨æ©Ÿæ•™å®¤ IDã€ -->
                <div id="random-classroom-number-title">éš¨æ©Ÿæ•™å®¤ ID</div>
                <!-- éš¨æ©Ÿæ•™å®¤ ID å±•ç¤º -->
                <div id="random-classroom-number"></div>
            </div>
            <!-- container å³æ–¹å€å¡Š -->
            <div id="create-new-classrooms-function-container-right">
                <!-- å­¸ç”Ÿåå–®è¼¸å…¥æ¡† -->
                <textarea
                    id="student-list-textarea"
                    placeholder="è«‹è¼¸å…¥å­¸ç”Ÿåå–®"
                ></textarea>
            </div>
        </div>
        <!-- button ã€Œæ–°å»ºæ•™å®¤ã€ -->
        <input
            id="create-new-classroom-button"
            type="button"
            value="æ–°å»ºæ•™å®¤"
        >
    </div>
    <script
        src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js'
        integrity='sha512-zoJXRvW2gC8Z0Xo3lBbao5+AS3g6YWr5ztKqaicua11xHo+AvE1b0lT9ODgrHTmNUxeCw0Ry4BGRYZfXu70weg=='
        crossorigin='anonymous'
    ></script>
    <script>
        const socket = io();
        let myID = '';

        socket.on('connected', (obj) => {
            if (myID === '') {
                console.log(`${obj.id}: ${obj.message}`);
                myID = obj.id;
                console.log(myID);
                // ç•¶ç¢ºèªè€å¸«é é¢é€£ç·šæˆåŠŸå¾Œï¼Œå‘ server ç«¯ç™¼é€è¨Šæ¯ä»¥å–å¾—ä¸€çµ„éš¨æ©Ÿæ•™å®¤ ID
                socket.emit('create-random-classroom-id', { id: myID });
                socket.emit('get-available-classroom', { id: myID });
            }
        });
        socket.on('create-random-classroom-id', (obj) => {
            // å¦‚æœ obj.id === myIDï¼Œå‰‡ä»£è¡¨æ­¤è¨Šæ¯æ˜¯è¦å‚³çµ¦æˆ‘
            if (obj.id === myID) {
                // å°‡éš¨æ©Ÿæ•™å®¤ ID é¡¯ç¤ºåœ¨é é¢ä¸Š
                document.querySelector('#random-classroom-number').innerText = obj.randomClassroomID;
            }
        });
        socket.on('get-available-classroom', (obj) => {
            // å¦‚æœ obj.id === myIDï¼Œå‰‡ä»£è¡¨æ­¤è¨Šæ¯æ˜¯è¦å‚³çµ¦æˆ‘
            if (obj.id === myID) {
                const chooseExistClassroomNumbersContainer = document.querySelector('#choose-exist-classroom-numbers-container');
                chooseExistClassroomNumbersContainer.innerHTML = '';
                if (obj.classroomIDs.length > 0) {
                    // å°‡å¯é¸æ“‡çš„æ•™å®¤ç·¨è™Ÿé¡¯ç¤ºåœ¨é é¢ä¸Š
                    for (let i = 0; i < obj.classroomIDs.length; i++) {
                        const classroomNumber = document.createElement('div');
                        classroomNumber.classList.add('classroom-number');
                        classroomNumber.innerText = obj.classroomIDs[i];
                        chooseExistClassroomNumbersContainer.appendChild(classroomNumber);
                    }
                } else {
                    // é¡¯ç¤ºã€Œç„¡å¯é¸æ“‡çš„æ•™å®¤ã€
                    const classroomNumber = document.createElement('div');
                    classroomNumber.classList.add('classroom-number');
                    classroomNumber.innerText = 'ç„¡å¯é¸æ“‡çš„æ•™å®¤';
                    chooseExistClassroomNumbersContainer.appendChild(classroomNumber);
                }
            }
        });
        socket.on('create-classroom', (obj) => {
            // å¦‚æœ obj.id === myIDï¼Œå‰‡ä»£è¡¨æ­¤è¨Šæ¯æ˜¯è¦å‚³çµ¦æˆ‘
            if (obj.id === myID) {
                // å‘ä½¿ç”¨è€…å€‘æ›´æ–°å¯é¸æ“‡çš„æ•™å®¤ç·¨è™Ÿ
                socket.emit('get-available-classroom', { id: myID });
                // TODO: è·³è½‰è‡³æ•™å®¤é é¢ï¼Œè·¯ç”±ç‚º /TEACHer/:obj.classroomID
                alert(`${obj.classroomID} æ•™å®¤å·²å»ºç«‹ï¼Œè«‹å‰å¾€æ•™å®¤é é¢`);
            }
        });

        // é»æ“Šã€Œæ–°å»ºæ•™å®¤ã€æŒ‰éˆ•æ™‚ï¼Œå‘ server ç«¯ç™¼é€è¨Šæ¯ä»¥å»ºç«‹æ–°æ•™å®¤
        document.querySelector('#create-new-classroom-button').addEventListener('click', () => {
            const studentListTextarea = document.querySelector('#student-list-textarea');
            const studentNames = studentListTextarea.value.split('\n');
            const randomClassroomID = document.querySelector('#random-classroom-number').innerText;
            socket.emit('create-classroom', {
                id: myID,
                classroomID: randomClassroomID,
                studentNames: studentNames
            });
        });
    </script>
</body>

</html>