<html>

<head>
    <title>å­¸ç”Ÿç™»å…¥</title>
    <meta charset="utf-8">
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        body {
            background-color: #D9D9D9;
            display: flex;
            justify-content: center;
        }

        .student-login-page {
            margin: 10px auto;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        h1 {
            text-align: center;
            font-size: 45px;
            color: #000000;
            margin: 0;
            padding: 0;
        }

        .form-group {
            margin: 100px auto;
            padding: 0px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            font-weight: bold;
        }

        .ID-box,
        .name-box {
            font-size: 20px;
            display: flex;
            justify-content: flex-end;
            margin: 0px 0px 0px 0px;
            padding: 5px 0 5px 0;
        }

        .ID,
        .name {
            margin: 0 0 0 20px;
            height: 30px;
            width: 150px;
            border-radius: 10px;
            font-size: 25px;
            text-align: center;
            border: none;
            box-shadow: 2px 3px 5px 0.5px #888888;
        }

        input[type=button] {
            display: block;
            background-color: #000000;
            margin: 10px auto;
            /* æ–‡å­—å¤§å° */
            font-size: 25px;
            color: #FFFFFF;
            padding: 7.5px 20px;
            border-radius: 10px;
            border: 1px solid #000000;
        }
    </style>
</head>

<body>
    <div class="student-login-page">
        <h1>Raise Your ğŸ–</h1>
        <div class="form-group">
            <div class="ID-box">
                <label for="ID">è¼¸å…¥æ•™å®¤ ID</label>
                <input
                    type="number"
                    class="ID"
                    value=""
                >
            </div>
            <div class="name-box">
                <label for="name">é¸æ“‡ä½ çš„å§“å</label>
                <select class="name">
                    <!-- <option value=""></option> -->
                </select>
            </div>
        </div>
        <input
            type="button"
            value="åŠ å…¥æ•™å®¤"
        >
    </div>
    <script
        src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js'
        integrity='sha512-zoJXRvW2gC8Z0Xo3lBbao5+AS3g6YWr5ztKqaicua11xHo+AvE1b0lT9ODgrHTmNUxeCw0Ry4BGRYZfXu70weg=='
        crossorigin='anonymous'
    ></script>
    <script>
        const socket = io();
        let myID = '';
        const IDInput = document.querySelector('.ID-box > input');
        const nameSelect = document.querySelector('.name');

        socket.on('connected', (obj) => {
            if (myID === '') {
                console.log(`${obj.id}: ${obj.message}`);
                myID = obj.id;
                console.log(myID);
            }
        });
        socket.on('verify-classroom-id', (obj) => {
            // å¦‚æœ obj.id === myIDï¼Œå‰‡ä»£è¡¨æ­¤è¨Šæ¯æ˜¯è¦å‚³çµ¦æˆ‘
            if (obj.id === myID) {
                if (obj.message === 'success') {
                    // æ–°å¢æ–°çš„ <option> è‡³ <select class=name>
                    nameSelect.innerHTML = '';
                    for (let i = 0; i < obj.studentNames.length; i++) {
                        const nameOption = document.createElement('option');
                        nameOption.value = obj.studentNames[i];
                        nameOption.innerText = obj.studentNames[i];
                        nameSelect.appendChild(nameOption);
                    }
                } else if (obj.message === 'fail') {
                    // æ¸…ç©º nameSelectï¼Œä¸¦ alert ç„¡æ­¤æ•™å®¤ ID
                    nameSelect.innerHTML = '';
                    alert("ç„¡æ­¤æ•™å®¤ IDï¼Œè«‹é‡æ–°è¼¸å…¥");
                }
            }
        });

        IDInput.addEventListener('keyup', () => {
            if (IDInput.value.length === 6) {
                // è¼¸å…¥é•·åº¦ç‚º 6 ä½æ•¸æ™‚ï¼Œç™¼é€ verify-classroom-id äº‹ä»¶
                socket.emit('verify-classroom-id', IDInput.value);
            } else if (IDInput.value.length > 6) {
                // é™åˆ¶è¼¸å…¥é•·åº¦ç‚º 6 ä½æ•¸
                IDInput.value = IDInput.value.slice(0, 6);
            } else {
                // è¼¸å…¥é•·åº¦å°æ–¼ 6 ä½æ•¸æ™‚ï¼Œæ¸…ç©º nameSelect
                nameSelect.innerHTML = '';
            }
        });
    </script>
</body>

</html>